# -*- coding: utf-8 -*-
"""utils.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1HLYsz7H5p5G8flIYFRXPpXgf5lxn7vLL
"""

import pandas as pd
# Function definitions
def read_usgs_data(file_path, header_line, timezone='US/Central', tz_convert='UTC'):
    df = pd.read_csv(file_path, sep='\t', header=header_line, engine='python')
    df.columns = ('org', 'site_num', 'datetime', 'timezone', 'USGS_Discharge', 'quality')
    df['datetime'] = pd.to_datetime(df['datetime'])
    df['datetime'] = df['datetime'].dt.tz_localize(timezone, ambiguous=True)
    df['datetime'] = df['datetime'].dt.tz_convert(tz_convert)
    # Filter data from year 2007 onwards
    df = df[df['datetime'].dt.year >= 2007]
    return df

def read_simulation_data(file_path, header_line, timezone='US/Central'):
    df = pd.read_csv(file_path, sep='\t', header=header_line, engine='python')
    df.columns = ('datetime', 'Sim_Discharge')
    df['datetime'] = pd.to_datetime(df['datetime'])
    df['datetime'] = df['datetime'].dt.tz_localize(timezone, ambiguous=True)
    # Filter data from year 2007 onwards
    df = df[df['datetime'].dt.year >= 2007]
    return df